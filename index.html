<!doctype html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title> All Pro Tools in 2026 </title>
  <!-- SortableJS for Drag and Drop -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <style>
    :root {
      --bg-primary: #f7f7fb;
      --bg-secondary: #fff;
      --text-primary: #111;
      --text-secondary: #666;
      --accent: #2b6cb0;
      --accent-hover: #1e4d7a;
      --border: #e0e0e0;
      --shadow: rgba(0,0,0,0.1);
    }
    
    [data-theme="dark"] {
      --bg-primary: #000000;
      --bg-secondary: #111111;
      --text-primary: #eee;
      --text-secondary: #aaa;
      --accent: #0f3460;
      --accent-hover: #16213e;
      --border: #333333;
      --shadow: rgba(0,0,0,0.4);
    }
    
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:system-ui,Segoe UI,Roboto,Arial;background:var(--bg-primary);color:var(--text-primary);position:relative;overflow-x:hidden;min-height:100vh;padding-top:60px;transition:all 0.3s}
    
    .header{position:fixed;top:0;left:0;right:0;background:#000000;box-shadow:0 2px 10px var(--shadow);z-index:1000;padding:12px 20px}
    .header-content{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
      20%, 40%, 60%, 80% { transform: translateX(5px); }
    }
    
    @keyframes rotate360 {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    @keyframes fallAndRise {
      0% { transform: translateY(0); opacity: 1; }
      50% { transform: translateY(300px); opacity: 0.8; }
      100% { transform: translateY(0); opacity: 1; }
    }
    
    .logo{
      font-size:32px;
      font-weight:bold;
      color:#ffffff;
      cursor:pointer;
      font-family:'Brush Script MT', cursive, 'Segoe Script', 'Comic Sans MS';
      font-style:italic;
      position:relative;
      letter-spacing:2px;
      text-shadow:2px 2px 4px rgba(255,255,255,0.3);
      animation: shake 0.8s ease-in-out;
      animation-iteration-count: 1;
    }
    .logo::after{
      content:'';
      position:absolute;
      bottom:-3px;
      left:0;
      width:100%;
      height:2px;
      background:#ffffff;
      transform:scaleX(0.95);
    }
    .header-actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .theme-toggle{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:6px;cursor:pointer;font-size:14px}
    .history-toggle-btn{background:#059669;color:#fff;border:0;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:14px}
    
    .history-sidebar{position:fixed;top:60px;right:-400px;width:380px;height:calc(100vh - 60px);background:var(--bg-secondary);box-shadow:-4px 0 20px var(--shadow);z-index:1500;transition:right 0.3s;overflow-y:auto;padding:20px}
    .history-sidebar.active{right:0}
    .history-sidebar h2{color:#2b6cb0;margin-bottom:15px}
    
    .container{max-width:1200px;margin:0 auto;padding:20px}
    .card{background:var(--bg-secondary);border-radius:12px;padding:30px;box-shadow:0 6px 18px rgba(18,18,18,0.06);margin-bottom:20px}
    h1{margin:0 0 10px;font-size:22px;color:#2b6cb0;text-align:center}
    h2{margin:20px 0 10px;font-size:18px;color:#2b6cb0}
    p{margin:6px 0;color:var(--text-secondary)}
    .muted{color:var(--text-secondary);font-size:13px;text-align:center}
    
    .tool-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-top:20px}
    @media (max-width:1024px){.tool-grid{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:768px){.tool-grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:480px){.tool-grid{grid-template-columns:1fr}}
    
    /* Statistics Section Responsive */
    #statisticsSection > div {
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:40px;
    }
    @media (max-width:1024px){
      #statisticsSection > div {
        grid-template-columns:repeat(2,1fr);
        gap:30px;
      }
    }
    @media (max-width:600px){
      #statisticsSection > div {
        grid-template-columns:1fr;
        gap:20px;
      }
      #statisticsSection {
        padding:30px 15px !important;
      }
    }
    
    /* Updated tool-card with border */
    .tool-card{
      background:var(--bg-secondary);
      border-radius:12px;
      padding:20px;
      box-shadow:0 6px 18px rgba(18,18,18,0.06);
      cursor:pointer;
      transition:transform 0.3s,box-shadow 0.3s,border 0.3s;
      border:3px solid #e0e7ff;
      position:relative;
    }
    .tool-card:hover{
      transform:translateY(-5px);
      box-shadow:0 10px 25px rgba(43,108,176,0.3);
      border-color:#2b6cb0;
    }
    .tool-card.premium{opacity:1;border:3px solid #e0e7ff !important}
    .tool-card.premium:hover{border-color:#2b6cb0 !important}
    .tool-card.premium::after{content:'ЁЯФТ Premium';position:absolute;top:10px;right:10px;background:#fbbf24;color:#000;padding:6px 12px;border-radius:6px;font-size:12px;font-weight:bold;box-shadow:0 2px 8px rgba(251,191,36,0.4)}
    
    /* Tool Icon Animations */
    .tool-icon{font-size:48px;margin-bottom:15px;text-align:center;display:inline-block}
    
    /* Merge animation - files coming together */
    @keyframes merge {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15) rotate(5deg); }
    }
    .tool-card[data-tool="merge"] .tool-icon {
      animation: merge 2s ease-in-out infinite;
    }
    
    /* Split animation - breaking apart */
    @keyframes split {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-3px); }
      75% { transform: translateX(3px); }
    }
    .tool-card[data-tool="split"] .tool-icon {
      animation: split 1.5s ease-in-out infinite;
    }
    
    /* Compress animation - squeeze effect */
    @keyframes compress {
      0%, 100% { transform: scaleY(1) scaleX(1); }
      50% { transform: scaleY(0.85) scaleX(1.1); }
    }
    .tool-card[data-tool="compress"] .tool-icon {
      animation: compress 2s ease-in-out infinite;
    }
    
    /* Rotate animation - spinning */
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .tool-card[data-tool="rotate"] .tool-icon {
      animation: spin 4s linear infinite;
    }
    
    /* Convert animation - transformation */
    @keyframes convert {
      0%, 100% { transform: scale(1) rotate(0deg); }
      50% { transform: scale(1.1) rotate(10deg); }
    }
    .tool-card[data-tool="img2pdf"] .tool-icon,
    .tool-card[data-tool="pdf2img"] .tool-icon {
      animation: convert 2.5s ease-in-out infinite;
    }
    
    /* Lock animation - up and down */
    @keyframes lock {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }
    .tool-card[data-tool="encrypt"] .tool-icon,
    .tool-card[data-tool="decrypt"] .tool-icon {
      animation: lock 1.8s ease-in-out infinite;
    }
    
    /* Page animation - flip effect */
    @keyframes pageFlip {
      0%, 100% { transform: rotateY(0deg); }
      50% { transform: rotateY(180deg); }
    }
    .tool-card[data-tool="organize"] .tool-icon,
    .tool-card[data-tool="extract"] .tool-icon {
      animation: pageFlip 3s ease-in-out infinite;
    }
    
    /* Bounce animation */
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .tool-card[data-tool="watermark"] .tool-icon {
      animation: bounce 2s ease-in-out infinite;
    }
    
    /* Pulse animation */
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.08); opacity: 0.9; }
    }
    .tool-card[data-tool="metadata"] .tool-icon {
      animation: pulse 2s ease-in-out infinite;
    }
    
    .tool-title{font-size:18px;font-weight:bold;color:#2b6cb0;margin-bottom:8px;text-align:center}
    .tool-desc{font-size:13px;color:var(--text-secondary);text-align:center}
    
    .premium-modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);z-index:2000;align-items:center;justify-content:center}
    .premium-modal.active{display:flex}
    .premium-content{background:var(--bg-secondary);padding:40px;border-radius:12px;max-width:500px;text-align:center}
    .premium-content h2{color:#f59e0b;margin-bottom:20px}
    .premium-content p{margin-bottom:20px}
    
    .history-item{background:var(--bg-primary);border:1px solid var(--border);padding:12px;border-radius:8px;margin-bottom:10px}
    .history-info h3{font-size:14px;color:#2b6cb0;margin-bottom:4px}
    .history-info p{font-size:12px;color:var(--text-secondary);margin:2px 0}
    .history-actions{display:flex;gap:8px;margin-top:8px}
    .history-actions button{padding:6px 12px;font-size:12px;border:0;border-radius:6px;cursor:pointer;background:#2b6cb0;color:#fff}
    
    .page{display:none}
    .page.active{display:block}
    .back-btn{background:#059669;color:#fff;border:0;padding:10px 20px;border-radius:8px;cursor:pointer;margin-bottom:20px;display:inline-flex;align-items:center;gap:5px}
    
    button{background:#2b6cb0;color:#fff;border:0;padding:12px 24px;border-radius:8px;cursor:pointer;margin:4px;font-size:15px;transition:background 0.3s}
    button:hover{background:var(--accent-hover)}
    button:disabled{background:#999;cursor:not-allowed}
    button.danger{background:#dc2626}
    button.danger:hover{background:#b91c1c}
    button.success{background:#059669}
    button.success:hover{background:#047857}
    .success-btn{background:#10b981;color:#fff;border:0;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:14px}
    
    input[type=file]{display:none}
    .file-upload-btn{background:#2b6cb0;color:#fff;border:0;padding:12px 24px;border-radius:8px;cursor:pointer;font-size:16px;display:inline-block}
    .center-content{display:flex;flex-direction:column;align-items:center;gap:15px;margin:20px 0}
    
    /* Enhanced preview with smooth drag animations */
    #preview{
      display:flex;
      flex-wrap:wrap;
      gap:15px;
      justify-content:center;
      margin:20px 0;
      min-height:150px;
      padding:10px;
    }
    
    .thumb{
      width:140px;
      height:140px;
      overflow:hidden;
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#f8f9ff;
      padding:8px;
      border:3px solid #e0e7ff;
      cursor:move;
      position:relative;
      transition:all 0.2s ease;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
    }
    
    .thumb:hover{
      transform:scale(1.05);
      border-color:#2b6cb0;
      box-shadow:0 4px 12px rgba(43,108,176,0.3);
    }
    
    .thumb.dragging{
      opacity:0.5;
      transform:scale(0.95);
    }
    
    .thumb.drag-over{
      border-color:#059669;
      background:#e8f5e9;
      border-style:dashed;
    }
    
    .thumb img{max-width:100%;max-height:100%;object-fit:contain}
    
    .thumb .delete-btn{
      position:absolute;
      top:4px;
      right:4px;
      background:rgba(220,38,38,0.95);
      color:#fff;
      border:0;
      border-radius:50%;
      width:28px;
      height:28px;
      cursor:pointer;
      font-size:18px;
      display:flex;
      align-items:center;
      justify-content:center;
      transition:all 0.2s;
    }
    
    .thumb .delete-btn:hover{
      background:#dc2626;
      transform:scale(1.15);
    }
    
    .thumb .page-number{
      position:absolute;
      bottom:4px;
      left:4px;
      background:rgba(43,108,176,0.95);
      color:#fff;
      padding:4px 8px;
      border-radius:6px;
      font-size:12px;
      font-weight:bold;
    }
    
    .quality-buttons{display:flex;gap:10px;justify-content:center;margin:15px 0}
    .quality-btn{background:#e5e7eb;color:#111;border:2px solid #e5e7eb;padding:10px 20px;border-radius:8px;cursor:pointer;font-size:14px;transition:all 0.3s}
    .quality-btn:hover{background:#d1d5db}
    .quality-btn.active{background:#2b6cb0;color:#fff;border-color:#2b6cb0}
    
    .info-box{background:#e8f4fd;padding:15px;border-radius:8px;margin:15px 0}
    .success-box{background:#d1fae5;padding:15px;border-radius:8px;margin:15px 0;border:1px solid #10b981}
    .warning-box{background:#fef3c7;padding:15px;border-radius:8px;margin:15px 0;border:1px solid #f59e0b}
    .error-box{background:#fee2e2;padding:15px;border-radius:8px;margin:15px 0;border:1px solid #dc2626}
    
    .progress{background:#e0e0e0;height:10px;border-radius:5px;overflow:hidden;margin:15px 0}
    .progress-bar{background:#2b6cb0;height:100%;width:0;transition:width 0.3s}
    
    .compare-container{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-top:15px}
    .compare-preview{border:2px solid #e5e7eb;border-radius:8px;padding:10px;background:var(--bg-primary)}
    .compare-preview h3{font-size:14px;color:#2b6cb0;margin-bottom:8px}
    .compare-preview canvas{width:100%;border:1px solid #ddd;border-radius:4px}
    .diff-highlight{background:#fef3c7;padding:8px;border-radius:6px;margin-top:10px;font-size:13px}
    
    input[type=password],input[type=text],input[type=number]{display:block;margin:10px auto;padding:10px;border:1px solid var(--border);border-radius:6px;width:100%;max-width:400px;background:var(--bg-primary);color:var(--text-primary)}
    select{padding:10px;border:1px solid var(--border);border-radius:6px;font-size:14px;background:var(--bg-primary);color:var(--text-primary)}
    
    .row{display:flex;gap:15px;align-items:center;margin:15px 0;flex-wrap:wrap;justify-content:center}
    label{font-size:14px;font-weight:500}
    hr{border:0;border-top:1px solid var(--border);margin:30px 0}
    
    /* PDF files preview list */
    .pdf-files-list{
      margin:20px 0;
      padding:10px;
    }
    .pdf-file-item{
      display:flex;
      align-items:center;
      gap:10px;
      padding:12px;
      background:var(--bg-primary);
      border:2px solid #e0e7ff;
      border-radius:8px;
      margin-bottom:10px;
      transition:all 0.2s;
    }
    .pdf-file-item:hover{
      border-color:#2b6cb0;
      box-shadow:0 2px 8px rgba(43,108,176,0.2);
    }
    .pdf-file-item .file-icon{
      font-size:32px;
    }
    .pdf-file-item .file-info{
      flex:1;
    }
    .pdf-file-item .file-name{
      font-weight:bold;
      color:#2b6cb0;
      font-size:14px;
    }
    .pdf-file-item .file-size{
      color:var(--text-secondary);
      font-size:12px;
    }
    .pdf-file-item .remove-file-btn{
      background:#dc2626;
      color:#fff;
      border:0;
      padding:6px 12px;
      border-radius:6px;
      cursor:pointer;
      font-size:12px;
    }
    
    /* Stats Section */
    .stats-section{
      background:linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
      padding:60px 20px;
      margin:40px 0 0 0;
      border-radius:0;
    }
    .stats-container{
      max-width:1200px;
      margin:0 auto;
      display:grid;
      grid-template-columns:repeat(4, 1fr);
      gap:40px;
      text-align:center;
    }
    .stat-item{
      color:#fff;
    }
    .stat-item h3{
      font-size:56px;
      font-weight:bold;
      margin-bottom:10px;
      text-shadow:2px 2px 4px rgba(0,0,0,0.2);
    }
    .stat-item p{
      font-size:20px;
      color:#fff;
      opacity:0.95;
    }
    
    @media (max-width:1024px){
      .stats-container{
        grid-template-columns:repeat(2, 1fr);
        gap:30px;
      }
    }
    
    @media (max-width:640px){
      .stats-container{
        grid-template-columns:1fr;
        gap:25px;
      }
      .stat-item h3{
        font-size:48px;
      }
      .stat-item p{
        font-size:18px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-content">
      <div class="logo" id="logoElement" onclick="rotateAndReload()"><span style="color:#00d9ff;">Dipto</span> <span style="color:#f59e0b;">Ray</span></div>
      <div class="header-actions">
        <button class="theme-toggle" onclick="toggleTheme()">ЁЯМУ</button>
        <button class="success-btn" onclick="showLoginRegister()">Login/Register</button>
      </div>
    </div>
  </div>

  <div class="history-sidebar" id="historySidebar">
    <h2>ЁЯУЬ ржЖржкржирж╛рж░ ржЗрждрж┐рж╣рж╛рж╕</h2>
    <div id="historyList"></div>
  </div>

  <!-- Login/Register Modal -->
  <div class="premium-modal" id="loginModal">
    <div class="premium-content">
      <h2>ЁЯФР Login / Register</h2>
      <input type="text" id="loginUsername" placeholder="Username" style="margin:10px 0">
      <input type="text" id="loginEmail" placeholder="Email" style="margin:10px 0">
      <input type="password" id="loginPassword" placeholder="Password" style="margin:10px 0">
      <div style="display:flex;gap:10px;justify-content:center;margin-top:15px">
        <button onclick="handleLogin()">Login</button>
        <button onclick="handleRegister()">Register</button>
        <button onclick="closeLoginRegister()" style="background:#999">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Premium Modal -->
  <div class="premium-modal" id="premiumModal">
    <div class="premium-content">
      <h2>ЁЯФТ Premium Feature</h2>
      <p id="premiumMessage">ржПржЗ ржлрж┐ржЪрж╛рж░ржЯрж┐ ржкрзНрж░рж┐ржорж┐ржпрж╝рж╛ржо ржнрж╛рж░рзНрж╕ржирзЗ ржЙржкрж▓ржмрзНржзред</p>
      <button onclick="closePremiumModal()">ржмржирзНржз ржХрж░рзБржи</button>
    </div>
  </div>

  <div class="container">
    <div id="home" class="page active">
      <div class="card">
        <p style="font-size:24px;font-weight:600;color:#2b6cb0;text-align:center;margin-bottom:25px;line-height:1.8">рж╕рзНржмрж▓рзНржк рж╕ржоржпрж╝рзЗ ржжрзНрж░рзБржд, ржирж┐рж░рзНржнрзБрж▓ ржУ ржирж┐рж░рзНржнрж░ржпрзЛржЧрзНржпржнрж╛ржмрзЗ ржпрзЗржХрзЛржирзЛ ржХрж╛ржЬ рж╕ржорзНржкржирзНржи ржХрж░рзБржиред<br>ржЖржкржирж╛рж░ ржкрзНрж░рждрж┐рж╖рзНржарж╛ржирзЗрж░ ржХрж╛ржЬржХрзЗ ржХрж░рзБржи ржЖрж░ржУ рж╕рж╣ржЬ ржУ ржкрзЗрж╢рж╛ржжрж╛рж░ред</p>
        
        <div class="tool-grid">
          <div class="tool-card" data-tool="img2pdf" onclick="showPage('img2pdf')">
            <div class="tool-icon">ЁЯУ╕</div>
            <div class="tool-title">Image to PDF рждрзИрж░рж┐ ржХрж░рзБржи</div>
            <div class="tool-desc">ржПржХрж╛ржзрж┐ржХ Image ржжрж┐ржпрж╝рзЗ PDF рждрзИрж░рж┐ ржХрж░рзБржи</div>
          </div>
          
          <div class="tool-card" data-tool="merge" onclick="showPage('merge')">
            <div class="tool-icon">ЁЯФЧ</div>
            <div class="tool-title">PDF ржПржХрждрзНрж░рж┐ржд ржХрж░рзБржи</div>
            <div class="tool-desc">ржПржХрж╛ржзрж┐ржХ PDF ржлрж╛ржЗрж▓ ржПржХржЯрж┐рждрзЗ ржПржХрждрзНрж░рзЗ ржХрж░рзБржи</div>
          </div>
          
          <div class="tool-card" data-tool="split" onclick="showPage('split')">
            <div class="tool-icon">тЬВя╕П</div>
            <div class="tool-title">PDF ржнрж╛ржЧ ржХрж░рзБржи</div>
            <div class="tool-desc"> ржПржХрж╛ржзрж┐ржХ PDF ржлрж╛ржЗрж▓ ржерзЗржХрзЗ ржЖрж▓рж╛ржжрж╛ ржкрзЗржЬрзЗ ржмрж┐ржнржХрзНржд ржХрж░рзБржи</div>
          </div>
          
          <div class="tool-card" data-tool="compress" onclick="showPage('compress')">
            <div class="tool-icon">ЁЯЧЬя╕П</div>
            <div class="tool-title">PDF ржХржоржкрзНрж░рзЗрж╕ ржХрж░рзБржи</div>
            <div class="tool-desc">PDF ржлрж╛ржЗрж▓рзЗрж░ рж╕рж╛ржЗржЬ ржЫрзЛржЯ ржХрж░рзБржи</div>
          </div>
          
          <div class="tool-card" data-tool="pdf2img" onclick="showPage('pdf2img')">
            <div class="tool-icon">ЁЯЦ╝я╕П</div>
            <div class="tool-title">PDF ржерзЗржХрзЗ Image</div>
            <div class="tool-desc">PDF ржХрзЗ JPG/PNG ржП рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рзБржи</div>
          </div>
          
          <div class="tool-card" data-tool="rotate" onclick="showPage('rotate')">
            <div class="tool-icon">ЁЯФД</div>
            <div class="tool-title">PDF ржЗржЪрзНржЫрж╛ ржоржд ржШрзБрж░рж╛ржи</div>
            <div class="tool-desc">PDF ржкрзЗржЬ ржШрзБрж░рж┐ржпрж╝рзЗ рж╕ржВрж╢рзЛржзржи ржХрж░рзБржи</div>
          </div>
          
          <div class="tool-card" data-tool="organize" onclick="showPage('organize')">
            <div class="tool-icon">ЁЯУС</div>
            <div class="tool-title">PDF ржкрзЗржЬ ржЗржЪрзНржЫрж╛ржоржд рж╕рж╛ржЬрж╛ржи</div>
            <div class="tool-desc">PDF ржкрзЗржЬ ржкрзБржирж░рзНржмрж┐ржирзНржпрж╛рж╕ ржХрж░рзБржи</div>
          </div>
          
          <div class="tool-card premium" data-tool="watermark" onclick="showPremiumModal('watermark')">
            <div class="tool-icon">ЁЯТз</div>
            <div class="tool-title">ржУржпрж╝рж╛ржЯрж╛рж░ржорж╛рж░рзНржХ ржпрзЛржЧ ржХрж░рзБржи</div>
            <div class="tool-desc">PDF ржП ржЯрзЗржХрзНрж╕ржЯ ржУржпрж╝рж╛ржЯрж╛рж░ржорж╛рж░рзНржХ ржпрзЛржЧ ржХрж░рзБржи</div>
          </div>
          
          <div class="tool-card premium" data-tool="encrypt" onclick="showPremiumModal('protect')">
            <div class="tool-icon">ЁЯФТ</div>
            <div class="tool-title">PDF рж╕рзБрж░ржХрзНрж╖рж┐ржд ржХрж░рзБржи</div>
            <div class="tool-desc">ржкрж╛рж╕ржУржпрж╝рж╛рж░рзНржб ржжрж┐ржпрж╝рзЗ PDF рж▓ржХ ржХрж░рзБржи</div>
          </div>
          
          <div class="tool-card premium" data-tool="decrypt" onclick="showPremiumModal('unlock')">
            <div class="tool-icon">ЁЯФУ</div>
            <div class="tool-title">PDF ржЖржирж▓ржХ ржХрж░рзБржи</div>
            <div class="tool-desc">ржкрж╛рж╕ржУржпрж╝рж╛рж░рзНржб рж╕рж░рж┐ржпрж╝рзЗ ржлрзЗрж▓рзБржи</div>
          </div>
          
          <div class="tool-card premium" data-tool="metadata" onclick="showPremiumModal('compare')">
            <div class="tool-icon">ЁЯФН</div>
            <div class="tool-title">PDF рждрзБрж▓ржирж╛ ржХрж░рзБржи</div>
            <div class="tool-desc">ржжрзБржЯрж┐ PDF ржПрж░ ржкрж╛рж░рзНржержХрзНржп ржжрзЗржЦрзБржи</div>
          </div>
          
          <div class="tool-card premium" data-tool="extract" onclick="showPremiumModal('ocr')">
            <div class="tool-icon">ЁЯУЭ</div>
            <div class="tool-title">OCR (ржЯрзЗржХрзНрж╕ржЯ рж╢ржирж╛ржХрзНржд)</div>
            <div class="tool-desc">рж╕рзНржХрзНржпрж╛ржи ржХрж░рж╛ PDF ржерзЗржХрзЗ ржЯрзЗржХрзНрж╕ржЯ ржмрзЗрж░ ржХрж░рзБржи</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Image to PDF Page -->
    <div id="img2pdf" class="page">
      <button class="back-btn" onclick="showPage('home');resetImageToPDF()">тЖР ржкрж┐ржЫржирзЗ ржпрж╛ржи</button>
      <div class="card">
        <div class="center-content">
          <label for="img2pdfInput" class="file-upload-btn">ЁЯУБ ржЫржмрж┐ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи (ржПржХрж╛ржзрж┐ржХ)</label>
          <input type="file" id="img2pdfInput" accept="image/*" multiple>
        </div>
        
        <div id="preview"></div>
        
        <div class="row">
          <label>ЁЯУД ржкрзЗржкрж╛рж░ рж╕рж╛ржЗржЬ:</label>
          <select id="paperSize">
            <option value="a4" selected>A4</option>
            <option value="letter">Letter</option>
            <option value="auto">Auto (ржЫржмрж┐рж░ рж╕рж╛ржЗржЬ ржЕржирзБржпрж╛ржпрж╝рзА)</option>
          </select>
        </div>
        
        <div class="center-content">
          <button onclick="convertImagesToPDF()" id="convertBtn" disabled>ЁЯФД PDF рждрзИрж░рж┐ ржХрж░рзБржи</button>
        </div>
      </div>
    </div>

    <!-- Merge PDF Page -->
    <div id="merge" class="page">
      <button class="back-btn" onclick="showPage('home');resetMergePDF()">тЖР ржкрж┐ржЫржирзЗ ржпрж╛ржи</button>
      <div class="card">
        <h2>ЁЯФЧ PDF ржПржХрждрзНрж░рж┐ржд ржХрж░рзБржи</h2>
        
        <div class="center-content">
          <label for="mergeInput" class="file-upload-btn">ЁЯУБ PDF ржлрж╛ржЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи (ржПржХрж╛ржзрж┐ржХ)</label>
          <input type="file" id="mergeInput" accept="application/pdf" multiple>
        </div>
        
        <div id="pdfFilesList" class="pdf-files-list"></div>
        
        <div class="center-content">
          <button onclick="mergePDFs()" id="mergeBtn" disabled>ЁЯФЧ ржПржХрждрзНрж░рж┐ржд ржХрж░рзБржи</button>
        </div>
      </div>
    </div>

    <!-- Split PDF Page -->
    <div id="split" class="page">
      <button class="back-btn" onclick="showPage('home');resetSplit()">тЖР ржкрж┐ржЫржирзЗ ржпрж╛ржи</button>
      <div class="card">
        <h2>тЬВя╕П PDF ржнрж╛ржЧ ржХрж░рзБржи</h2>
        
        <div class="center-content">
          <label for="splitInput" class="file-upload-btn">ЁЯУБ PDF ржлрж╛ржЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</label>
          <input type="file" id="splitInput" accept="application/pdf">
        </div>
        
        <div id="splitFileInfo" class="info-box" style="display:none;margin-top:15px"></div>
        
        <div id="splitPreview" style="display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin:20px 0"></div>
        
        <div class="row">
          <label>ржкрзЗржЬ ржиржорзНржмрж░:</label>
          <input type="number" id="splitPage" min="1" placeholder="ржпрзЗ ржкрзЗржЬ ржЖрж▓рж╛ржжрж╛ ржХрж░рждрзЗ ржЪрж╛ржи">
        </div>
        
        <div class="center-content">
          <button onclick="splitPDF()" id="splitBtn" disabled>тЬВя╕П ржкрзЗржЬ ржЖрж▓рж╛ржжрж╛ ржХрж░рзБржи</button>
        </div>
      </div>
    </div>

    <!-- Compress PDF Page -->
    <div id="compress" class="page">
      <button class="back-btn" onclick="showPage('home');resetCompress()">тЖР ржкрж┐ржЫржирзЗ ржпрж╛ржи</button>
      <div class="card">
        <h2>ЁЯЧЬя╕П PDF ржХржоржкрзНрж░рзЗрж╕ ржХрж░рзБржи</h2>
        
        <div class="center-content">
          <label for="compressInput" class="file-upload-btn">ЁЯУБ PDF ржлрж╛ржЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</label>
          <input type="file" id="compressInput" accept="application/pdf">
        </div>
        
        <div id="compressFileInfo" class="info-box" style="display:none;margin-top:15px"></div>
        
        <div class="info-box" style="max-width:600px;margin:20px auto;text-align:center">
          <p style="margin:0"><strong>тЬи рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржЕржкржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи:</strong> ржЖржкржирж╛рж░ PDF ржлрж╛ржЗрж▓ржЯрж┐ рж╕рж░рзНржмрзЛржЪрзНржЪ ржЧрзБржгржорж╛ржи ржмржЬрж╛ржпрж╝ рж░рзЗржЦрзЗ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ ржХржоржкрзНрж░рзЗрж╕ ржХрж░рж╛ рж╣ржмрзЗред</p>
        </div>
        
        <div class="progress" id="compressProgress" style="display:none">
          <div class="progress-bar" id="compressProgressBar"></div>
        </div>
        
        <div id="compressSizeInfo" class="success-box" style="display:none"></div>
        
        <div class="center-content">
          <button onclick="compressPDF()" id="compressBtn" disabled>ЁЯЧЬя╕П ржХржоржкрзНрж░рзЗрж╕ ржХрж░рзБржи</button>
        </div>
      </div>
    </div>

    <!-- PDF to Image Page -->
    <div id="pdf2img" class="page">
      <button class="back-btn" onclick="showPage('home')">тЖР ржкрж┐ржЫржирзЗ ржпрж╛ржи</button>
      <div class="card">
        <h2>ЁЯЦ╝я╕П PDF ржерзЗржХрзЗ ржЫржмрж┐</h2>
        
        <div class="center-content">
          <label for="pdf2imgInput" class="file-upload-btn">ЁЯУБ PDF ржлрж╛ржЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</label>
          <input type="file" id="pdf2imgInput" accept="application/pdf">
        </div>
        
        <div class="row">
          <label>ржЫржмрж┐рж░ ржлрж░ржорзНржпрж╛ржЯ:</label>
          <select id="imgFormat">
            <option value="png">PNG (ржЙржЪрзНржЪ ржорж╛ржи)</option>
            <option value="jpeg">JPEG (ржЫрзЛржЯ рж╕рж╛ржЗржЬ)</option>
          </select>
        </div>
        
        <div class="progress" id="pdf2imgProgress" style="display:none">
          <div class="progress-bar" id="pdf2imgProgressBar"></div>
        </div>
        
        <div id="pdf2imgStatus" class="info-box" style="display:none"></div>
        
        <div class="center-content">
          <button onclick="convertPDFtoImages()" id="pdf2imgBtn" disabled>ЁЯЦ╝я╕П рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рзБржи</button>
        </div>
        
        <div id="imgPreview"></div>
      </div>
    </div>

    <!-- Rotate PDF Page -->
    <div id="rotate" class="page">
      <button class="back-btn" onclick="showPage('home')">тЖР ржкрж┐ржЫржирзЗ ржпрж╛ржи</button>
      <div class="card">
        <h2>ЁЯФД PDF ржШрзБрж░рж╛ржи</h2>
        
        <div class="center-content">
          <label for="rotateInput" class="file-upload-btn">ЁЯУБ PDF ржлрж╛ржЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</label>
          <input type="file" id="rotateInput" accept="application/pdf">
        </div>
        
        <div class="row">
          <label>ржХрзЛржи ржжрж┐ржХрзЗ ржШрзБрж░рж╛ржмрзЗржи:</label>
          <select id="rotateAngle">
            <option value="90">рзпрзж┬░ (ржбрж╛ржи ржжрж┐ржХрзЗ)</option>
            <option value="180">рззрзорзж┬░</option>
            <option value="270">рзирзнрзж┬░ (ржмрж╛ржо ржжрж┐ржХрзЗ)</option>
          </select>
        </div>
        
        <div class="center-content">
          <button onclick="rotatePDF()">ЁЯФД ржШрзБрж░рж╛ржи</button>
        </div>
      </div>
    </div>

    <!-- Watermark Page -->
    <div id="watermark" class="page">
      <button class="back-btn" onclick="showPage('home')">тЖР ржкрж┐ржЫржирзЗ ржпрж╛ржи</button>
      <div class="card">
        <h2>ЁЯТз ржУржпрж╝рж╛ржЯрж╛рж░ржорж╛рж░рзНржХ ржпрзЛржЧ ржХрж░рзБржи</h2>
        
        <div class="center-content">
          <label for="watermarkInput" class="file-upload-btn">ЁЯУБ PDF ржлрж╛ржЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</label>
          <input type="file" id="watermarkInput" accept="application/pdf">
        </div>
        
        <div class="row">
          <label>ржУржпрж╝рж╛ржЯрж╛рж░ржорж╛рж░рзНржХ ржЯрзЗржХрзНрж╕ржЯ:</label>
          <input type="text" id="watermarkText" placeholder="ржпрзЗржоржи: Confidential">
        </div>
        
        <div class="center-content">
          <button onclick="addWatermark()">ЁЯТз ржпрзЛржЧ ржХрж░рзБржи</button>
        </div>
      </div>
    </div>

    <!-- Protect PDF Page -->
    <div id="protect" class="page">
      <button class="back-btn" onclick="showPage('home')">тЖР ржкрж┐ржЫржирзЗ ржпрж╛ржи</button>
      <div class="card">
        <h2>ЁЯФТ PDF рж╕рзБрж░ржХрзНрж╖рж┐ржд ржХрж░рзБржи</h2>
        
        <div class="center-content">
          <label for="protectInput" class="file-upload-btn">ЁЯУБ PDF ржлрж╛ржЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</label>
          <input type="file" id="protectInput" accept="application/pdf">
        </div>
        
        <div class="row">
          <label>ржкрж╛рж╕ржУржпрж╝рж╛рж░рзНржб:</label>
          <input type="password" id="protectPassword" placeholder="рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржкрж╛рж╕ржУржпрж╝рж╛рж░рзНржб ржжрж┐ржи">
        </div>
        
        <div class="center-content">
          <button onclick="protectPDF()">ЁЯФТ рж╕рзБрж░ржХрзНрж╖рж┐ржд ржХрж░рзБржи</button>
        </div>
      </div>
    </div>

    <!-- Organize PDF Page -->
    <div id="organize" class="page">
      <button class="back-btn" onclick="showPage('home')">тЖР ржкрж┐ржЫржирзЗ ржпрж╛ржи</button>
      <div class="card">
        <h2>ЁЯУС ржкрзЗржЬ рж╕рж╛ржЬрж╛ржи</h2>
        
        <div class="center-content">
          <label for="organizeInput" class="file-upload-btn">ЁЯУБ PDF ржлрж╛ржЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи</label>
          <input type="file" id="organizeInput" accept="application/pdf">
        </div>
        
        <div id="organizePreview"></div>
        
        <div class="center-content">
          <button onclick="organizePDF()" id="organizeBtn" disabled>ЁЯУС рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржи</button>
        </div>
      </div>
    </div>

  </div>


  <!-- Stats Section (Only on Home Page) -->
  <div class="stats-section" id="statsSection">
    <div class="stats-container">
      <div class="stat-item">
        <h3>рззрзж+</h3>
        <p>рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржЯрзБрж▓рж╕</p>
      </div>
      <div class="stat-item">
        <h3>NaN+</h3>
        <p>рж╕ржирзНрждрзБрж╖рзНржЯ ржХрж╛рж╕рзНржЯржорж╛рж░</p>
      </div>
      <div class="stat-item">
        <h3>24/7</h3>
        <p>рж╕ржмрж╕ржоржпрж╝ ржЙржкрж▓ржмрзНржз</p>
      </div>
      <div class="stat-item">
        <h3>Free</h3>
        <p>рж╕ржорзНржкрзВрж░рзНржг ржмрж┐ржирж╛ржорзВрж▓рзНржпрзЗ</p>
      </div>
    </div>
  </div>
  </div>
  
  <footer id="mainFooter" style="background:#000000;margin-top:0;border-top:none;padding:40px 20px 20px">
    <div style="max-width:1200px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:40px;text-align:center">
      
      <!-- Contact Section -->
      <div>
        <h3 style="color:#ffffff;margin-bottom:15px;font-size:18px">Contact</h3>
        <p style="color:#ffffff;font-weight:600;margin:8px 0">Dipto Ray</p>
        <p style="color:#cccccc;margin:8px 0">ЁЯУЮ +880 1305482427</p>
        
        <!-- Social Media Icons -->
        <div style="display:flex;justify-content:center;gap:25px;margin-top:20px;align-items:center">
          <!-- Facebook -->
          <a href="https://www.facebook.com/real.diptoray" target="_blank" style="color:#1877f2;transition:all 0.3s;display:inline-block" onmouseover="this.style.transform='scale(1.2)'" onmouseout="this.style.transform='scale(1)'">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg>
          </a>
          
          <!-- YouTube -->
          <a href="https://www.youtube.com/@diptoray" target="_blank" style="color:#FF0000;transition:all 0.3s;display:inline-block" onmouseover="this.style.transform='scale(1.2)'" onmouseout="this.style.transform='scale(1)'">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
              <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
            </svg>
          </a>
          
          <!-- X (Twitter) -->
          <a href="https://twitter.com/diptoray" target="_blank" style="color:#ffffff;transition:all 0.3s;display:inline-block" onmouseover="this.style.transform='scale(1.2)'" onmouseout="this.style.transform='scale(1)'">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
              <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
            </svg>
          </a>
        </div>
      </div>
      
      <!-- Privacy Policy Section -->
      <div>
        <h3 style="color:#ffffff;margin-bottom:15px;font-size:18px">Privacy Policy</h3>
        <p style="color:#cccccc;font-size:14px;line-height:1.6;margin:8px 0">ржЖржкржирж╛рж░ рж╕ржХрж▓ ржбрзЗржЯрж╛ рж╕ржорзНржкрзВрж░рзНржг ржирж┐рж░рж╛ржкржжред рж╕ржХрж▓ ржкрзНрж░рж╕рзЗрж╕рж┐ржВ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗржЗ рж╣ржпрж╝, ржХрзЛржирзЛ рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржбрзЗржЯрж╛ ржкрж╛ржарж╛ржирзЛ рж╣ржпрж╝ ржирж╛ред</p>
      </div>
      
    </div>
    
    <!-- Copyright -->
    <div style="text-align:center;margin-top:30px;padding-top:20px;border-top:1px solid #333333">
      <p style="color:#cccccc;font-size:14px;margin:0">┬й Copyright 2026 - All Rights Reserved</p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/jspdf@latest/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js';
    
    // ============== NOTIFICATION SYSTEM ==============
    async function requestNotificationPermission() {
      if ("Notification" in window && Notification.permission === "default") {
        await Notification.requestPermission();
      }
    }

    function showNotification(title, message) {
      // Play success sound
      try {
        const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBjaP1fPTgjMGHm7A7+OZSA==');
        audio.volume = 0.3;
        audio.play().catch(() => {});
      } catch(e) {}

      // Show browser notification
      if ("Notification" in window && Notification.permission === "granted") {
        new Notification(title, {
          body: message,
          icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="75" font-size="75">тЬЕ</text></svg>',
          badge: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="75" font-size="75">ЁЯУД</text></svg>'
        });
      }
    }

    // Request notification permission on page load
    requestNotificationPermission();
    
    let selectedQuality = 0.95;
    let selectedCompressionLevel = 'medium';
    let selectedScale = 2;
    let isProcessing = false;
    let pagesForOrganize = [];
    let selectedImages = [];
    let selectedPDFs = [];
    
    // Page Navigation
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');
      window.scrollTo(0, 0);
      
      // Show footer and stats section only on home page
      const footer = document.getElementById('mainFooter');
      const statsSection = document.getElementById('statsSection');
      if (pageId === 'home') {
        if (footer) footer.style.display = 'block';
        if (statsSection) statsSection.style.display = 'block';
      } else {
        if (footer) footer.style.display = 'none';
        if (statsSection) statsSection.style.display = 'none';
      }
    }
    
    // Theme Toggle
    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      html.setAttribute('data-theme', currentTheme === 'dark' ? '' : 'dark');
      localStorage.setItem('theme', html.getAttribute('data-theme'));
    }
    
    // Load saved theme
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) document.documentElement.setAttribute('data-theme', savedTheme);
    
    // History Sidebar
    function toggleHistory() {
      document.getElementById('historySidebar').classList.toggle('active');
    }
    
    // Login/Register Functions
    function showLoginRegister() {
      document.getElementById('loginModal').classList.add('active');
    }
    
    function closeLoginRegister() {
      document.getElementById('loginModal').classList.remove('active');
    }
    
    function handleLogin() {
      const username = document.getElementById('loginUsername').value;
      const password = document.getElementById('loginPassword').value;
      
      if (username && password) {
        alert('Login рж╕ржлрж▓ рж╣ржпрж╝рзЗржЫрзЗ! Welcome ' + username);
        closeLoginRegister();
      } else {
        alert('Username ржПржмржВ Password ржжрж┐ржи');
      }
    }
    
    function handleRegister() {
      const username = document.getElementById('loginUsername').value;
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      
      if (username && email && password) {
        alert('Registration рж╕ржлрж▓ рж╣ржпрж╝рзЗржЫрзЗ! ржПржЦржи Login ржХрж░рзБржи');
        closeLoginRegister();
      } else {
        alert('рж╕ржХрж▓ рждржерзНржп ржкрзВрж░ржг ржХрж░рзБржи');
      }
    }
    
    // Premium Modal
    function showPremiumModal(feature) {
      const messages = {
        unlock: 'PDF ржЖржирж▓ржХ ржХрж░рж╛ ржкрзНрж░рж┐ржорж┐ржпрж╝рж╛ржо ржлрж┐ржЪрж╛рж░ред ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржЖржкржЧрзНрж░рзЗржб ржХрж░рзБржиред',
        compare: 'PDF рждрзБрж▓ржирж╛ ржХрж░рж╛ ржкрзНрж░рж┐ржорж┐ржпрж╝рж╛ржо ржлрж┐ржЪрж╛рж░ред ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржЖржкржЧрзНрж░рзЗржб ржХрж░рзБржиред',
        ocr: 'OCR ржЯрзЗржХрзНрж╕ржЯ рж╢ржирж╛ржХрзНрждржХрж░ржг ржкрзНрж░рж┐ржорж┐ржпрж╝рж╛ржо ржлрж┐ржЪрж╛рж░ред ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржЖржкржЧрзНрж░рзЗржб ржХрж░рзБржиред',
        watermark: 'ржУржпрж╝рж╛ржЯрж╛рж░ржорж╛рж░рзНржХ ржпрзЛржЧ ржХрж░рж╛ ржкрзНрж░рж┐ржорж┐ржпрж╝рж╛ржо ржлрж┐ржЪрж╛рж░ред ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржЖржкржЧрзНрж░рзЗржб ржХрж░рзБржиред',
        protect: 'PDF рж╕рзБрж░ржХрзНрж╖рж┐ржд ржХрж░рж╛ ржкрзНрж░рж┐ржорж┐ржпрж╝рж╛ржо ржлрж┐ржЪрж╛рж░ред ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржЖржкржЧрзНрж░рзЗржб ржХрж░рзБржиред'
      };
      document.getElementById('premiumMessage').textContent = messages[feature] || 'ржПржЯрж┐ ржПржХржЯрж┐ ржкрзНрж░рж┐ржорж┐ржпрж╝рж╛ржо ржлрж┐ржЪрж╛рж░ред';
      document.getElementById('premiumModal').classList.add('active');
    }
    
    function closePremiumModal() {
      document.getElementById('premiumModal').classList.remove('active');
    }
    
    // Quality Button Selection
    document.querySelectorAll('.quality-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        this.parentElement.querySelectorAll('.quality-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        if (this.dataset.quality) selectedQuality = parseFloat(this.dataset.quality);
        if (this.dataset.level) selectedCompressionLevel = this.dataset.level;
        if (this.dataset.scale) selectedScale = parseFloat(this.dataset.scale);
      });
    });
    
    // ============== IMAGE TO PDF WITH SORTABLEJS DRAG-DROP ==============
    let sortableInstance = null;
    
    document.getElementById('img2pdfInput').addEventListener('change', function(e) {
      const files = Array.from(e.target.files);
      files.forEach(file => {
        if (file.type.startsWith('image/')) {
          selectedImages.push(file);
        }
      });
      updateImagePreview();
    });
    
    function updateImagePreview() {
      const preview = document.getElementById('preview');
      preview.innerHTML = '';
      
      if (selectedImages.length === 0) {
        document.getElementById('convertBtn').disabled = true;
        if (sortableInstance) {
          sortableInstance.destroy();
          sortableInstance = null;
        }
        return;
      }
      
      document.getElementById('convertBtn').disabled = false;
      
      selectedImages.forEach((file, index) => {
        const reader = new FileReader();
        reader.onload = function(e) {
          const div = document.createElement('div');
          div.className = 'thumb';
          div.dataset.index = index;
          
          const img = document.createElement('img');
          img.src = e.target.result;
          
          const deleteBtn = document.createElement('button');
          deleteBtn.className = 'delete-btn';
          deleteBtn.textContent = '├Ч';
          deleteBtn.onclick = (event) => {
            event.stopPropagation();
            removeImage(index);
          };
          
          const pageNum = document.createElement('div');
          pageNum.className = 'page-number';
          pageNum.textContent = index + 1;
          
          div.appendChild(img);
          div.appendChild(deleteBtn);
          div.appendChild(pageNum);
          
          preview.appendChild(div);
          
          // Initialize SortableJS after all items are added
          if (index === selectedImages.length - 1) {
            setTimeout(() => {
              initSortable();
            }, 100);
          }
        };
        reader.readAsDataURL(file);
      });
    }
    
    function initSortable() {
      const preview = document.getElementById('preview');
      
      // Destroy previous instance if exists
      if (sortableInstance) {
        sortableInstance.destroy();
      }
      
      // Create new SortableJS instance
      sortableInstance = new Sortable(preview, {
        animation: 200,
        ghostClass: 'dragging',
        dragClass: 'dragging',
        chosenClass: 'drag-over',
        forceFallback: false,
        fallbackTolerance: 3,
        scroll: true,
        scrollSensitivity: 100,
        scrollSpeed: 10,
        bubbleScroll: true,
        
        // Handle order change
        onEnd: function(evt) {
          // Update the selectedImages array to match new order
          const newOrder = [];
          const thumbs = preview.querySelectorAll('.thumb');
          
          thumbs.forEach((thumb, newIndex) => {
            const oldIndex = parseInt(thumb.dataset.index);
            newOrder.push(selectedImages[oldIndex]);
            
            // Update page numbers
            const pageNum = thumb.querySelector('.page-number');
            if (pageNum) {
              pageNum.textContent = newIndex + 1;
            }
            thumb.dataset.index = newIndex;
          });
          
          selectedImages = newOrder;
          
          // Update delete button onclick handlers
          thumbs.forEach((thumb, index) => {
            const deleteBtn = thumb.querySelector('.delete-btn');
            if (deleteBtn) {
              deleteBtn.onclick = (event) => {
                event.stopPropagation();
                removeImage(index);
              };
            }
          });
        }
      });
    }
    
    function removeImage(index) {
      selectedImages.splice(index, 1);
      updateImagePreview();
    }
    
    async function convertImagesToPDF() {
      if (selectedImages.length === 0 || isProcessing) return;
      isProcessing = true;
      
      try {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF();
        const paperSize = document.getElementById('paperSize').value;
        
        for (let i = 0; i < selectedImages.length; i++) {
          const img = await loadImageAsync(selectedImages[i]);
          
          if (i > 0) pdf.addPage();
          
          let width, height;
          if (paperSize === 'a4') {
            width = 210;
            height = 297;
          } else if (paperSize === 'letter') {
            width = 215.9;
            height = 279.4;
          } else {
            const ratio = img.width / img.height;
            width = ratio > 1 ? 297 : 210;
            height = ratio > 1 ? 210 : 297;
          }
          
          const imgRatio = img.width / img.height;
          const pageRatio = width / height;
          
          let imgWidth, imgHeight;
          if (imgRatio > pageRatio) {
            imgWidth = width;
            imgHeight = width / imgRatio;
          } else {
            imgHeight = height;
            imgWidth = height * imgRatio;
          }
          
          const x = (width - imgWidth) / 2;
          const y = (height - imgHeight) / 2;
          
          pdf.addImage(img.src, 'JPEG', x, y, imgWidth, imgHeight, undefined, 'FAST');
        }
        
        pdf.save('converted.pdf');
        
        saveToHistory('ржЫржмрж┐ ржерзЗржХрзЗ PDF', 'converted.pdf', {
          count: selectedImages.length
        });
        
        showNotification('ржХрж╛ржЬ рж╕ржорзНржкржирзНржи', 'ржЫржмрж┐ ржерзЗржХрзЗ PDF рждрзИрж░рж┐ рж╣ржпрж╝рзЗржЫрзЗ!');
        alert('тЬЕ PDF рж╕ржлрж▓ржнрж╛ржмрзЗ рждрзИрж░рж┐ рж╣ржпрж╝рзЗржЫрзЗ!');
      } catch (err) {
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      } finally {
        isProcessing = false;
      }
    }
    
    function loadImageAsync(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = function(e) {
          const img = new Image();
          img.onload = () => {
            img.src = e.target.result;
            resolve(img);
          };
          img.onerror = reject;
          img.src = e.target.result;
        };
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }
    
    // ============== MERGE MULTIPLE PDFs ==============
    document.getElementById('mergeInput').addEventListener('change', function(e) {
      const files = Array.from(e.target.files);
      files.forEach(file => {
        if (file.type === 'application/pdf') {
          selectedPDFs.push(file);
        }
      });
      updatePDFList();
    });
    
    function updatePDFList() {
      const list = document.getElementById('pdfFilesList');
      list.innerHTML = '';
      
      if (selectedPDFs.length === 0) {
        document.getElementById('mergeBtn').disabled = true;
        return;
      }
      
      document.getElementById('mergeBtn').disabled = false;
      
      selectedPDFs.forEach((file, index) => {
        const item = document.createElement('div');
        item.className = 'pdf-file-item';
        
        item.innerHTML = `
          <div class="file-icon">ЁЯУД</div>
          <div class="file-info">
            <div class="file-name">${file.name}</div>
            <div class="file-size">${(file.size / 1024).toFixed(2)} KB</div>
          </div>
          <button class="remove-file-btn" onclick="removePDF(${index})">тЬХ ржорзБржЫрзБржи</button>
        `;
        
        list.appendChild(item);
      });
    }
    
    function removePDF(index) {
      selectedPDFs.splice(index, 1);
      updatePDFList();
    }
    
    async function mergePDFs() {
      if (selectedPDFs.length < 2 || isProcessing) {
        alert('ржЕржирзНрждржд рзиржЯрж┐ PDF ржлрж╛ржЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржиред');
        return;
      }
      isProcessing = true;
      
      try {
        const { PDFDocument } = PDFLib;
        const mergedPdf = await PDFDocument.create();
        
        for (const file of selectedPDFs) {
          const arrayBuffer = await file.arrayBuffer();
          const pdf = await PDFDocument.load(arrayBuffer);
          const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
          copiedPages.forEach(page => mergedPdf.addPage(page));
        }
        
        const pdfBytes = await mergedPdf.save();
        const blob = new Blob([pdfBytes], { type: 'application/pdf' });
        
        // Download without opening new tab
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'merged.pdf';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        const reader = new FileReader();
        reader.onload = () => {
          saveToHistory('PDF ржПржХрждрзНрж░рж┐ржд', 'merged.pdf', {
            base64: reader.result.split(',')[1],
            mimeType: 'application/pdf',
            downloadName: 'merged.pdf',
            size: blob.size,
            count: selectedPDFs.length
          });
        };
        reader.readAsDataURL(blob);
        
        showNotification('ржХрж╛ржЬ рж╕ржорзНржкржирзНржи', 'PDF ржПржХрждрзНрж░рж┐ржд рж╣ржпрж╝рзЗржЫрзЗ!');
        alert('тЬЕ PDF рж╕ржлрж▓ржнрж╛ржмрзЗ ржПржХрждрзНрж░рж┐ржд рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ ржбрж╛ржЙржирж▓рзЛржб рж╣ржЪрзНржЫрзЗ!');
      } catch (err) {
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      } finally {
        isProcessing = false;
      }
    }
    
    // ============== SPLIT PDF ==============
    document.getElementById('splitInput').addEventListener('change', async function(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      const fileInfo = document.getElementById('splitFileInfo');
      const splitBtn = document.getElementById('splitBtn');
      const preview = document.getElementById('splitPreview');
      preview.innerHTML = '';
      
      try {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        
        fileInfo.style.display = 'block';
        fileInfo.innerHTML = `
          <strong>ЁЯУД ржлрж╛ржЗрж▓:</strong> ${file.name}<br>
          <strong>ЁЯУК рж╕рж╛ржЗржЬ:</strong> ${(file.size / 1024).toFixed(2)} KB<br>
          <strong>ЁЯУС ржорзЛржЯ ржкрзЗржЬ:</strong> ${pdf.numPages}
        `;
        
        // Show preview of all pages
        for (let i = 1; i <= pdf.numPages; i++) {
          const page = await pdf.getPage(i);
          const viewport = page.getViewport({ scale: 0.3 });
          
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          canvas.width = viewport.width;
          canvas.height = viewport.height;
          
          await page.render({ canvasContext: ctx, viewport }).promise;
          
          const div = document.createElement('div');
          div.style.cssText = 'text-align:center;border:2px solid #e0e7ff;border-radius:8px;padding:8px;background:#f8f9ff;cursor:pointer';
          div.onclick = () => {
            document.getElementById('splitPage').value = i;
          };
          
          const img = document.createElement('img');
          img.src = canvas.toDataURL();
          img.style.cssText = 'width:100px;border-radius:4px';
          
          const label = document.createElement('div');
          label.textContent = 'ржкрзЗржЬ ' + i;
          label.style.cssText = 'margin-top:5px;font-size:12px;font-weight:bold;color:#2b6cb0';
          
          div.appendChild(img);
          div.appendChild(label);
          preview.appendChild(div);
          
          canvas.width = 0;
          canvas.height = 0;
        }
        
        document.getElementById('splitPage').max = pdf.numPages;
        splitBtn.disabled = false;
      } catch (err) {
        fileInfo.style.display = 'block';
        fileInfo.innerHTML = '<strong style="color:#dc2626">рждрзНрж░рзБржЯрж┐:</strong> PDF ржлрж╛ржЗрж▓ рж▓рзЛржб ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ';
        splitBtn.disabled = true;
      }
    });
    
    async function splitPDF() {
      const file = document.getElementById('splitInput').files[0];
      const pageNum = parseInt(document.getElementById('splitPage').value);
      
      if (!file || !pageNum || isProcessing) return;
      isProcessing = true;
      
      try {
        const { PDFDocument } = PDFLib;
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await PDFDocument.load(arrayBuffer);
        
        if (pageNum < 1 || pageNum > pdf.getPageCount()) {
          alert('ржЕржмрзИржз ржкрзЗржЬ ржиржорзНржмрж░!');
          isProcessing = false;
          return;
        }
        
        const newPdf = await PDFDocument.create();
        const [copiedPage] = await newPdf.copyPages(pdf, [pageNum - 1]);
        newPdf.addPage(copiedPage);
        
        const pdfBytes = await newPdf.save();
        const blob = new Blob([pdfBytes], { type: 'application/pdf' });
        
        // Download without opening new tab
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `page_${pageNum}.pdf`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        const reader = new FileReader();
        reader.onload = () => {
          saveToHistory('ржкрзЗржЬ ржЖрж▓рж╛ржжрж╛', `page_${pageNum}.pdf`, {
            base64: reader.result.split(',')[1],
            mimeType: 'application/pdf',
            downloadName: `page_${pageNum}.pdf`,
            size: blob.size
          });
        };
        reader.readAsDataURL(blob);
        
        showNotification('ржХрж╛ржЬ рж╕ржорзНржкржирзНржи', 'ржкрзЗржЬ ржЖрж▓рж╛ржжрж╛ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ!');
        alert('тЬЕ ржкрзЗржЬ рж╕ржлрж▓ржнрж╛ржмрзЗ ржЖрж▓рж╛ржжрж╛ рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ ржбрж╛ржЙржирж▓рзЛржб рж╣ржЪрзНржЫрзЗ!');
      } catch (err) {
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      } finally {
        isProcessing = false;
      }
    }
    
    // ============== COMPRESS PDF ==============
    document.getElementById('compressInput').addEventListener('change', async function(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      const fileInfo = document.getElementById('compressFileInfo');
      const compressBtn = document.getElementById('compressBtn');
      
      try {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        
        fileInfo.style.display = 'block';
        fileInfo.innerHTML = `
          <strong>ЁЯУД ржлрж╛ржЗрж▓:</strong> ${file.name}<br>
          <strong>ЁЯУК рж╕рж╛ржЗржЬ:</strong> ${(file.size / 1024).toFixed(2)} KB<br>
          <strong>ЁЯУС ржкрзЗржЬ рж╕ржВржЦрзНржпрж╛:</strong> ${pdf.numPages}
        `;
        compressBtn.disabled = false;
      } catch (err) {
        fileInfo.style.display = 'block';
        fileInfo.innerHTML = '<strong style="color:#dc2626">рждрзНрж░рзБржЯрж┐:</strong> PDF ржлрж╛ржЗрж▓ рж▓рзЛржб ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗ';
        compressBtn.disabled = true;
      }
    });
    
    async function compressPDF() {
      const file = document.getElementById('compressInput').files[0];
      if (!file || isProcessing) return;
      isProcessing = true;
      
      const progressBar = document.getElementById('compressProgressBar');
      const progress = document.getElementById('compressProgress');
      const sizeInfo = document.getElementById('compressSizeInfo');
      progress.style.display = 'block';
      progressBar.style.width = '0%';
      
      try {
        const { PDFDocument } = PDFLib;
        const arrayBuffer = await file.arrayBuffer();
        const pdfDoc = await PDFDocument.load(arrayBuffer);
        
        // Get selected quality
        const qualitySelect = document.querySelector('input[name="quality"]:checked');
        let imageQuality = 0.5; // default medium
        let scale = 1.0;
        
        if (qualitySelect) {
          const quality = qualitySelect.value;
          if (quality === 'low') {
            imageQuality = 0.3;
            scale = 0.7;
          } else if (quality === 'medium') {
            imageQuality = 0.5;
            scale = 0.85;
          } else if (quality === 'high') {
            imageQuality = 0.7;
            scale = 1.0;
          }
        }
        
        const numPages = pdfDoc.getPageCount();
        progressBar.style.width = '30%';
        
        // Create new PDF with compressed images
        const arrayBufferOriginal = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBufferOriginal }).promise;
        
        const { jsPDF } = window.jspdf;
        const compressedPdf = new jsPDF();
        let firstPage = true;
        
        for (let i = 1; i <= numPages; i++) {
          progressBar.style.width = (30 + (i / numPages) * 60) + '%';
          
          const page = await pdf.getPage(i);
          const viewport = page.getViewport({ scale: scale });
          
          const canvas = document.createElement('canvas');
          const context = canvas.getContext('2d');
          canvas.width = viewport.width;
          canvas.height = viewport.height;
          
          await page.render({
            canvasContext: context,
            viewport: viewport
          }).promise;
          
          // Convert to JPEG with compression
          const imgData = canvas.toDataURL('image/jpeg', imageQuality);
          
          if (!firstPage) {
            compressedPdf.addPage();
          }
          firstPage = false;
          
          // Calculate aspect ratio to fit A4
          const imgWidth = 210; // A4 width in mm
          const imgHeight = (canvas.height * imgWidth) / canvas.width;
          
          compressedPdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight, undefined, 'FAST');
        }
        
        progressBar.style.width = '95%';
        
        const compressedBlob = compressedPdf.output('blob');
        
        progressBar.style.width = '100%';
        
        // Check if compression actually reduced size
        if (compressedBlob.size >= file.size) {
          alert('тЪая╕П ржПржЗ PDF ржЗрждрж┐ржоржзрзНржпрзЗ ржЕржкрзНржЯрж┐ржорж╛ржЗржЬржбред ржЖрж░рзЛ ржХржоржкрзНрж░рзЗрж╕ ржХрж░рж╛ рж╕ржорзНржнржм ржиржпрж╝ред\n\nржорзВрж▓ рж╕рж╛ржЗржЬ: ' + (file.size / 1024).toFixed(2) + ' KB\nржХржоржкрзНрж░рзЗрж╕ржб рж╕рж╛ржЗржЬ: ' + (compressedBlob.size / 1024).toFixed(2) + ' KB');
          isProcessing = false;
          progress.style.display = 'none';
          return;
        }
        
        // Download compressed PDF
        const url = URL.createObjectURL(compressedBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'compressed_' + file.name;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        const reduction = ((file.size - compressedBlob.size) / file.size) * 100;
        
        sizeInfo.style.display = 'block';
        sizeInfo.innerHTML = `<strong>тЬЕ рж╕ржлрж▓!</strong><br>
                              <strong>ржорзВрж▓ рж╕рж╛ржЗржЬ:</strong> ${(file.size / 1024).toFixed(2)} KB<br>
                              <strong>ржХржоржкрзНрж░рзЗрж╕ржб рж╕рж╛ржЗржЬ:</strong> ${(compressedBlob.size / 1024).toFixed(2)} KB<br>
                              <strong>рж╕рж╛рж╢рзНрж░ржпрж╝:</strong> ${reduction.toFixed(1)}%`;
        
        const reader = new FileReader();
        reader.onload = () => {
          saveToHistory('PDF ржХржоржкрзНрж░рзЗрж╕', 'compressed_' + file.name, {
            base64: reader.result.split(',')[1],
            mimeType: 'application/pdf',
            downloadName: 'compressed_' + file.name,
            size: compressedBlob.size,
            originalSize: file.size
          });
        };
        reader.readAsDataURL(compressedBlob);
        
        showNotification('ржХрж╛ржЬ рж╕ржорзНржкржирзНржи', 'PDF ржХржоржкрзНрж░рзЗрж╕ рж╣ржпрж╝рзЗржЫрзЗ!');
        alert('тЬЕ PDF рж╕ржлрж▓ржнрж╛ржмрзЗ ржХржоржкрзНрж░рзЗрж╕ рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ ржбрж╛ржЙржирж▓рзЛржб рж╣ржЪрзНржЫрзЗ!\n\n' + reduction.toFixed(1) + '% рж╕рж╛ржЗржЬ ржХржорзЗржЫрзЗ!');
      } catch (err) {
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      } finally {
        isProcessing = false;
        setTimeout(() => {
          progress.style.display = 'none';
          progressBar.style.width = '0%';
        }, 2000);
      }
    }
    
    // ============== PDF TO IMAGES ==============
    document.getElementById('pdf2imgInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      document.getElementById('pdf2imgBtn').disabled = !file;
    });
    
    async function convertPDFtoImages() {
      const file = document.getElementById('pdf2imgInput').files[0];
      if (!file || isProcessing) return;
      isProcessing = true;
      
      const format = document.getElementById('imgFormat').value;
      const imgPreview = document.getElementById('imgPreview');
      const progress = document.getElementById('pdf2imgProgress');
      const progressBar = document.getElementById('pdf2imgProgressBar');
      const status = document.getElementById('pdf2imgStatus');
      
      imgPreview.innerHTML = '';
      progress.style.display = 'block';
      status.style.display = 'block';
      status.innerHTML = 'тП│ ржХрж╛ржЬ ржЪрж▓ржЫрзЗ... ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзБржи';
      
      try {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        
        const images = [];
        
        for (let i = 1; i <= pdf.numPages; i++) {
          progressBar.style.width = ((i / pdf.numPages) * 100) + '%';
          status.innerHTML = `тП│ ржкрзНрж░рж╕рзЗрж╕ рж╣ржЪрзНржЫрзЗ... ржкрзЗржЬ ${i}/${pdf.numPages}`;
          
          const page = await pdf.getPage(i);
          const viewport = page.getViewport({ scale: 2 });
          
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          canvas.width = viewport.width;
          canvas.height = viewport.height;
          
          await page.render({ canvasContext: ctx, viewport }).promise;
          
          const imgData = format === 'png' 
            ? canvas.toDataURL('image/png')
            : canvas.toDataURL('image/jpeg', 0.95);
          
          images.push({
            data: imgData,
            name: `page_${i}.${format}`
          });
          
          canvas.width = 0;
          canvas.height = 0;
        }
        
        // If single page, download directly
        if (images.length === 1) {
          const link = document.createElement('a');
          link.href = images[0].data;
          link.download = images[0].name;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          status.innerHTML = 'тЬЕ рззржЯрж┐ ржЫржмрж┐ рж╕ржлрж▓ржнрж╛ржмрзЗ ржбрж╛ржЙржирж▓рзЛржб рж╣ржпрж╝рзЗржЫрзЗ!';
        } else {
          // For multiple pages, download all
          status.innerHTML = 'тП│ ржлрж╛ржЗрж▓ржЧрзБрж▓рзЛ ржбрж╛ржЙржирж▓рзЛржб рж╣ржЪрзНржЫрзЗ...';
          
          for (let img of images) {
            const link = document.createElement('a');
            link.href = img.data;
            link.download = img.name;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Small delay between downloads
            await new Promise(resolve => setTimeout(resolve, 100));
          }
          
          status.innerHTML = `тЬЕ ${images.length} ржЯрж┐ ржЫржмрж┐ рж╕ржлрж▓ржнрж╛ржмрзЗ ржбрж╛ржЙржирж▓рзЛржб рж╣ржпрж╝рзЗржЫрзЗ!`;
        }
        
        saveToHistory('PDF ржерзЗржХрзЗ ржЫржмрж┐', `${pdf.numPages} ржЯрж┐ ржЫржмрж┐`, {
          count: pdf.numPages,
          format: format
        });
        
        showNotification('ржХрж╛ржЬ рж╕ржорзНржкржирзНржи', `${pdf.numPages}ржЯрж┐ ржЫржмрж┐ рждрзИрж░рж┐ рж╣ржпрж╝рзЗржЫрзЗ!`);
        alert(`тЬЕ ${pdf.numPages} ржЯрж┐ ржЫржмрж┐ рж╕ржлрж▓ржнрж╛ржмрзЗ рждрзИрж░рж┐ ржПржмржВ ржбрж╛ржЙржирж▓рзЛржб рж╣ржпрж╝рзЗржЫрзЗ!`);
      } catch (err) {
        status.innerHTML = 'тЭМ рждрзНрж░рзБржЯрж┐: ' + err.message;
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      } finally {
        isProcessing = false;
        progressBar.style.width = '100%';
        setTimeout(() => {
          progress.style.display = 'none';
          progressBar.style.width = '0%';
        }, 2000);
      }
    }
    
    // ============== ROTATE PDF ==============
    async function rotatePDF() {
      const file = document.getElementById('rotateInput').files[0];
      const angle = parseInt(document.getElementById('rotateAngle').value);
      
      if (!file || isProcessing) return;
      isProcessing = true;
      
      try {
        const { PDFDocument, degrees } = PDFLib;
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await PDFDocument.load(arrayBuffer);
        
        const pages = pdf.getPages();
        pages.forEach(page => page.setRotation(degrees(angle)));
        
        const pdfBytes = await pdf.save();
        const blob = new Blob([pdfBytes], { type: 'application/pdf' });
        
        // Download without opening new tab
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'rotated.pdf';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        const reader = new FileReader();
        reader.onload = () => {
          saveToHistory('PDF ржШрзБрж░рж╛ржирзЛ', 'rotated.pdf', {
            base64: reader.result.split(',')[1],
            mimeType: 'application/pdf',
            downloadName: 'rotated.pdf',
            size: blob.size,
            angle: angle
          });
        };
        reader.readAsDataURL(blob);
        
        showNotification('ржХрж╛ржЬ рж╕ржорзНржкржирзНржи', 'PDF ржШрзБрж░рж╛ржирзЛ рж╣ржпрж╝рзЗржЫрзЗ!');
        alert('тЬЕ PDF рж╕ржлрж▓ржнрж╛ржмрзЗ ржШрзБрж░рж╛ржирзЛ рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ ржбрж╛ржЙржирж▓рзЛржб рж╣ржЪрзНржЫрзЗ!');
      } catch (err) {
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      } finally {
        isProcessing = false;
      }
    }
    
    // ============== WATERMARK ==============
    async function addWatermark() {
      const file = document.getElementById('watermarkInput').files[0];
      const text = document.getElementById('watermarkText').value;
      
      if (!file || !text || isProcessing) return;
      isProcessing = true;
      
      try {
        const { PDFDocument, rgb } = PDFLib;
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await PDFDocument.load(arrayBuffer);
        
        const pages = pdf.getPages();
        pages.forEach(page => {
          const { width, height } = page.getSize();
          page.drawText(text, {
            x: width / 2 - (text.length * 10),
            y: height / 2,
            size: 50,
            color: rgb(0.7, 0.7, 0.7),
            opacity: 0.3
          });
        });
        
        const pdfBytes = await pdf.save();
        const blob = new Blob([pdfBytes], { type: 'application/pdf' });
        
        // Download without opening new tab
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'watermarked.pdf';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        const reader = new FileReader();
        reader.onload = () => {
          saveToHistory('ржУржпрж╝рж╛ржЯрж╛рж░ржорж╛рж░рзНржХ ржпрзЛржЧ', 'watermarked.pdf', {
            base64: reader.result.split(',')[1],
            mimeType: 'application/pdf',
            downloadName: 'watermarked.pdf',
            size: blob.size,
            watermark: text
          });
        };
        reader.readAsDataURL(blob);
        
        alert('тЬЕ ржУржпрж╝рж╛ржЯрж╛рж░ржорж╛рж░рзНржХ рж╕ржлрж▓ржнрж╛ржмрзЗ ржпрзЛржЧ рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ ржбрж╛ржЙржирж▓рзЛржб рж╣ржЪрзНржЫрзЗ!');
      } catch (err) {
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      } finally {
        isProcessing = false;
      }
    }
    
    // ============== PROTECT PDF ==============
    async function protectPDF() {
      const file = document.getElementById('protectInput').files[0];
      const password = document.getElementById('protectPassword').value;
      
      if (!file || !password || isProcessing) return;
      isProcessing = true;
      
      try {
        const { PDFDocument } = PDFLib;
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await PDFDocument.load(arrayBuffer);
        
        // Note: pdf-lib doesn't support password encryption directly
        // This is a placeholder - real encryption requires additional libraries
        const pdfBytes = await pdf.save();
        const blob = new Blob([pdfBytes], { type: 'application/pdf' });
        
        // Download without opening new tab
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'protected.pdf';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        alert('тЬЕ PDF рж╕ржВрж░ржХрзНрж╖рж┐ржд рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ ржбрж╛ржЙржирж▓рзЛржб рж╣ржЪрзНржЫрзЗ! (ржирзЛржЯ: ржмрзНрж░рж╛ржЙржЬрж╛рж░-ржнрж┐рждрзНрждрж┐ржХ ржЯрзБрж▓рзЗ рж╕ржорзНржкрзВрж░рзНржг ржПржиржХрзНрж░рж┐ржкрж╢ржи рж╕рзАржорж┐ржд)');
      } catch (err) {
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      } finally {
        isProcessing = false;
      }
    }
    
    // ============== ORGANIZE PDF ==============
    document.getElementById('organizeInput').addEventListener('change', async (e) => {
      const file = e.target.files[0];
      if (!file) return;
      
      try {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
        
        pagesForOrganize = [];
        const preview = document.getElementById('organizePreview');
        preview.innerHTML = '';
        
        for (let i = 1; i <= pdf.numPages; i++) {
          const page = await pdf.getPage(i);
          const viewport = page.getViewport({ scale: 0.5 });
          
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          canvas.width = viewport.width;
          canvas.height = viewport.height;
          
          await page.render({ canvasContext: ctx, viewport }).promise;
          
          const div = document.createElement('div');
          div.className = 'thumb';
          div.draggable = true;
          div.dataset.pageNum = i;
          
          const img = document.createElement('img');
          img.src = canvas.toDataURL();
          div.appendChild(img);
          
          const deleteBtn = document.createElement('button');
          deleteBtn.className = 'delete-btn';
          deleteBtn.textContent = '├Ч';
          deleteBtn.onclick = () => removePageFromOrganize(i);
          div.appendChild(deleteBtn);
          
          const pageNum = document.createElement('div');
          pageNum.className = 'page-number';
          pageNum.textContent = i;
          div.appendChild(pageNum);
          
          div.addEventListener('dragstart', handlePageDragStart);
          div.addEventListener('dragover', handlePageDragOver);
          div.addEventListener('drop', handlePageDrop);
          div.addEventListener('dragend', handlePageDragEnd);
          div.addEventListener('dragleave', handlePageDragLeave);
          
          preview.appendChild(div);
          pagesForOrganize.push(i);
          
          canvas.width = 0;
          canvas.height = 0;
        }
        
        document.getElementById('organizeBtn').disabled = false;
      } catch (err) {
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      }
    });
    
    function removePageFromOrganize(pageNum) {
      const index = pagesForOrganize.indexOf(pageNum);
      if (index > -1) {
        pagesForOrganize.splice(index, 1);
        const preview = document.getElementById('organizePreview');
        preview.children[index].remove();
      }
    }
    
    let draggedPage = null;
    
    function handlePageDragStart(e) {
      draggedPage = this;
      this.classList.add('dragging');
    }
    
    function handlePageDragOver(e) {
      if (e.preventDefault) e.preventDefault();
      if (draggedPage !== this) {
        this.classList.add('drag-over');
      }
      return false;
    }
    
    function handlePageDragLeave(e) {
      this.classList.remove('drag-over');
    }
    
    function handlePageDrop(e) {
      if (e.stopPropagation) e.stopPropagation();
      
      if (draggedPage !== this) {
        const preview = document.getElementById('organizePreview');
        const allThumbs = Array.from(preview.children);
        
        const fromIndex = allThumbs.indexOf(draggedPage);
        const toIndex = allThumbs.indexOf(this);
        
        const temp = pagesForOrganize[fromIndex];
        pagesForOrganize.splice(fromIndex, 1);
        pagesForOrganize.splice(toIndex, 0, temp);
        
        if (fromIndex < toIndex) {
          preview.insertBefore(draggedPage, this.nextSibling);
        } else {
          preview.insertBefore(draggedPage, this);
        }
      }
      
      this.classList.remove('drag-over');
      return false;
    }
    
    function handlePageDragEnd(e) {
      this.classList.remove('dragging');
      document.querySelectorAll('.thumb').forEach(el => {
        el.classList.remove('drag-over');
      });
    }
    
    async function organizePDF() {
      if (isProcessing) return;
      isProcessing = true;
      
      const file = document.getElementById('organizeInput').files[0];
      if (!file || pagesForOrganize.length === 0) {
        isProcessing = false;
        return;
      }
      
      try {
        const { PDFDocument } = PDFLib;
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await PDFDocument.load(arrayBuffer);
        
        const newPdf = await PDFDocument.create();
        const pageIndices = pagesForOrganize.map(n => n - 1);
        const copiedPages = await newPdf.copyPages(pdf, pageIndices);
        copiedPages.forEach(page => newPdf.addPage(page));
        
        const pdfBytes = await newPdf.save();
        const blob = new Blob([pdfBytes], { type: 'application/pdf' });
        
        // Download without opening new tab
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'organized.pdf';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        const reader = new FileReader();
        reader.onload = () => {
          saveToHistory('ржкрзЗржЬ рж╕рж╛ржЬрж╛ржирзЛ', 'organized.pdf', {
            base64: reader.result.split(',')[1],
            mimeType: 'application/pdf',
            downloadName: 'organized.pdf',
            size: blob.size
          });
        };
        reader.readAsDataURL(blob);
        
        showNotification('ржХрж╛ржЬ рж╕ржорзНржкржирзНржи', 'PDF ржкрзЗржЬ рж╕рж╛ржЬрж╛ржирзЛ рж╣ржпрж╝рзЗржЫрзЗ!');
        alert('тЬЕ PDF рж╕ржлрж▓ржнрж╛ржмрзЗ рж╕рж╛ржЬрж╛ржирзЛ рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ ржбрж╛ржЙржирж▓рзЛржб рж╣ржЪрзНржЫрзЗ!');
      } catch (err) {
        alert('рждрзНрж░рзБржЯрж┐: ' + err.message);
      } finally {
        isProcessing = false;
      }
    }
    
    // ============== HISTORY MANAGEMENT ==============
    function saveToHistory(action, filename, data) {
      const history = JSON.parse(localStorage.getItem('pdfHistory') || '[]');
      history.unshift({
        id: Date.now(),
        action: action,
        filename: filename,
        timestamp: new Date().toLocaleString('bn-BD'),
        data: data
      });
      
      if (history.length > 50) history.pop();
      localStorage.setItem('pdfHistory', JSON.stringify(history));
      loadHistory();
    }
    
    function loadHistory() {
      const history = JSON.parse(localStorage.getItem('pdfHistory') || '[]');
      const historyList = document.getElementById('historyList');
      
      if (history.length === 0) {
        historyList.innerHTML = '<p style="text-align:center;color:var(--text-secondary)">ржХрзЛржирзЛ ржЗрждрж┐рж╣рж╛рж╕ ржирзЗржЗ</p>';
        return;
      }
      
      historyList.innerHTML = '';
      history.forEach(item => {
        const div = document.createElement('div');
        div.className = 'history-item';
        div.innerHTML = `
          <div class="history-info">
            <h3>${item.action}</h3>
            <p>ЁЯУБ ${item.filename}</p>
            <p>ЁЯХТ ${item.timestamp}</p>
          </div>
          <div class="history-actions">
            ${item.data && item.data.base64 ? `<button onclick="downloadFromHistory(${item.id})">тмЗ ржбрж╛ржЙржирж▓рзЛржб</button>` : ''}
            <button onclick="deleteHistory(${item.id})">ЁЯЧСя╕П ржорзБржЫрзБржи</button>
          </div>
        `;
        historyList.appendChild(div);
      });
    }
    
    function downloadFromHistory(id) {
      const history = JSON.parse(localStorage.getItem('pdfHistory') || '[]');
      const item = history.find(h => h.id === id);
      
      if (item && item.data && item.data.base64) {
        const link = document.createElement('a');
        link.href = `data:${item.data.mimeType};base64,${item.data.base64}`;
        link.download = item.data.downloadName || item.filename;
        link.click();
      }
    }
    
    function deleteHistory(id) {
      if (!confirm('ржПржЗ ржЗрждрж┐рж╣рж╛рж╕ ржорзБржЫрзЗ ржлрзЗрж▓ржмрзЗржи?')) return;
      
      const history = JSON.parse(localStorage.getItem('pdfHistory') || '[]');
      const filtered = history.filter(h => h.id !== id);
      localStorage.setItem('pdfHistory', JSON.stringify(filtered));
      loadHistory();
    }
    
    // Initialize
    loadHistory();
    
    // Animated Counter Function
    function animateCounter(elementId, start, end, duration, suffix = '') {
      const element = document.getElementById(elementId);
      if (!element) return;
      
      const range = end - start;
      const increment = range / (duration / 16); // 60 FPS
      let current = start;
      
      const timer = setInterval(() => {
        current += increment;
        if (current >= end) {
          element.textContent = end.toLocaleString('bn-BD') + suffix;
          clearInterval(timer);
        } else {
          element.textContent = Math.floor(current).toLocaleString('bn-BD') + suffix;
        }
      }, 16);
    }
    
    // Start counters on page load
    window.addEventListener('load', function() {
      // Logo rotation
      const logo = document.getElementById('logoElement');
      if (logo) {
        logo.style.animation = 'rotate360 0.6s ease-in-out';
      }
      
      // Animate counters
      animateCounter('toolsCounter', 0, 10, 2000, '+');
      animateCounter('customersCounter', 0, 5000, 3000, '+');
      
      // Increment customer counter every 10 seconds
      setInterval(() => {
        const customerEl = document.getElementById('customersCounter');
        if (customerEl) {
          const currentValue = parseInt(customerEl.textContent.replace(/[^0-9]/g, ''));
          const newValue = currentValue + Math.floor(Math.random() * 5) + 1; // Random 1-5 increase
          customerEl.textContent = newValue.toLocaleString('bn-BD') + '+';
        }
      }, 10000); // Every 10 seconds
    });
    
    
    // Logo shake animation followed by fall and rise every 3 seconds
    setInterval(function() {
      const logo = document.getElementById('logoElement');
      if (logo) {
        // Only shake animation
        logo.style.animation = 'shake 0.8s ease-in-out';
        
        // Reset animation
        setTimeout(() => {
          logo.style.animation = 'none';
        }, 800); // shake duration
      }
    }, 3000); // 3 seconds
    
    // Function to rotate 360 degrees and reload
    function rotateAndReload() {
      const logo = document.getElementById('logoElement');
      if (logo) {
        logo.style.animation = 'rotate360 0.6s ease-in-out';
        setTimeout(() => {
          location.reload();
        }, 600); // Wait for rotation to complete
      }
    }
    
    
    // Reset functions for back button
    function resetImageToPDF() {
      selectedImages = [];
      document.getElementById('img2pdfInput').value = '';
      document.getElementById('preview').innerHTML = '';
      document.getElementById('convertBtn').disabled = true;
      if (sortableInstance) {
        sortableInstance.destroy();
        sortableInstance = null;
      }
    }
    
    function resetMergePDF() {
      selectedPDFs = [];
      document.getElementById('mergeInput').value = '';
      document.getElementById('pdfFilesList').innerHTML = '';
      document.getElementById('mergeBtn').disabled = true;
    }
    
    function resetSplit() {
      document.getElementById('splitInput').value = '';
      document.getElementById('splitFileInfo').style.display = 'none';
      document.getElementById('splitPreview').innerHTML = '';
      document.getElementById('splitPage').value = '';
      document.getElementById('splitBtn').disabled = true;
    }
    
    function resetCompress() {
      document.getElementById('compressInput').value = '';
      document.getElementById('compressFileInfo').style.display = 'none';
      document.getElementById('compressProgress').style.display = 'none';
      document.getElementById('compressSizeInfo').style.display = 'none';
      document.getElementById('compressBtn').disabled = true;
    }
  </script>
</body>
</html>
